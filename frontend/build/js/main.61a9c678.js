(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("Vue"),require("axios")):"function"===typeof define&&define.amd?define(["Vue","axios"],t):"object"===typeof exports?exports["blogComponents"]=t(require("Vue"),require("axios")):e["blogComponents"]=t(e["Vue"],e["axios"])})(self,(function(e,t){return function(){"use strict";var n={625:function(){(function(){var e=document.querySelector(".search-button-mobile"),t=document.querySelector(".search-button-mobile-cancel");null===e||void 0===e||e.addEventListener("click",(function(e){console.log("searchBtnMobile"),e.preventDefault(),document.querySelector(".search-form-mobile-wrapper").style.display="block",document.querySelector(".search-form-mobile input[type=search]").focus()})),null===t||void 0===t||t.addEventListener("click",(function(e){e&&e.preventDefault(),document.querySelector(".search-form-mobile-wrapper").style.display="none"}))})()},5:function(t){t.exports=e},376:function(e){e.exports=t}},o={};function c(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e](r,r.exports,c),r.exports}!function(){c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,{a:t}),t}}(),function(){c.d=function(e,t){for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}();var r={};return function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}c.r(r),c.d(r,{default:function(){return pe}});var o=function(){function t(n){e(this,t),this._element=n,this._init()}return n(t,[{key:"_init",value:function(){var e;window.addEventListener("scroll",this.toggle.bind(this)),null===(e=this._element)||void 0===e||e.addEventListener("click",this.to.bind(this))}},{key:"to",value:function(){document.documentElement.scrollTop>0&&document.documentElement.scrollTo({top:0,behavior:"smooth"})}},{key:"toggle",value:function(){var e,t,n=window.innerHeight/3;document.documentElement.scrollTop>n?null===(e=this._element)||void 0===e||e.classList.add("fade-in"):null===(t=this._element)||void 0===t||t.classList.remove("fade-in")}}]),t}(),i=o;function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}var l=function(){function e(t,n){a(this,e),this._trigger=n,this._isShown=!1,this._element=t,this._init()}return m(e,[{key:"_init",value:function(){this._trigger&&this._trigger.addEventListener("click",this.show.bind(this),!1),document.addEventListener("click",this.hide.bind(this),!0),this.toggle=this.toggle.bind(this)}},{key:"toggle",value:function(){this._isShown?this.hide():this.show()}},{key:"show",value:function(){this._isShown||(this._isShown=!0,document.body.classList.add("offcanvas-backdrop"),this._element.classList.add("show"))}},{key:"hide",value:function(e){this._isShown&&(this._element.contains(e.target)||e.target===this._element||(this._isShown=!1,this._element.classList.remove("show"),document.body.classList.remove("offcanvas-backdrop")))}}]),e}(),u=l,d=(c(625),c(5)),p={key:1,class:"flex-center top-gap-big"},f=(0,d.createTextVNode)("加载更多 "),h=(0,d.createVNode)("i",{class:"ri-arrow-down-s-line"},null,-1),y={key:1,class:"text-small text-muted"};function k(e,t,n,o,c,r){var i=(0,d.resolveComponent)("comment-form"),a=(0,d.resolveComponent)("comment-list");return(0,d.openBlock)(),(0,d.createBlock)("div",null,[e.isAuthenticated?((0,d.openBlock)(),(0,d.createBlock)(i,{key:0,"content-type":e.contentType,"object-pk":e.objectPk,token:e.token,flag:"root",onRootCommentSuccess:e.commentSuccess},null,8,["content-type","object-pk","token","onRootCommentSuccess"])):(0,d.createCommentVNode)("",!0),(0,d.createVNode)(a,{"content-type":e.contentType,"object-pk":e.objectPk,token:e.token,"comment-list":e.commentList,"num-comments":e.numComments,"num-comment-participants":e.numCommentParticipants},null,8,["content-type","object-pk","token","comment-list","num-comments","num-comment-participants"]),e.hasMore?((0,d.openBlock)(),(0,d.createBlock)("div",p,[e.loading?((0,d.openBlock)(),(0,d.createBlock)("span",y,"加载中...")):((0,d.openBlock)(),(0,d.createBlock)("a",{key:0,class:"text-small text-muted",href:"",onClick:t[1]||(t[1]=(0,d.withModifiers)((function(){return e.loadMore&&e.loadMore.apply(e,arguments)}),["prevent"]))},[f,h]))])):(0,d.createCommentVNode)("",!0)])}function b(e,t,n,o,c,r){var i=(0,d.resolveComponent)("comment-item");return(0,d.openBlock)(),(0,d.createBlock)("div",null,[(0,d.createVNode)("h5",null,(0,d.toDisplayString)(n.numComments)+" 条评论 / "+(0,d.toDisplayString)(n.numCommentParticipants)+" 人参与",1),((0,d.openBlock)(!0),(0,d.createBlock)(d.Fragment,null,(0,d.renderList)(n.commentList,(function(e){return(0,d.openBlock)(),(0,d.createBlock)(i,{key:e.id,comment:e,"content-type":n.contentType,"object-pk":n.objectPk,token:n.token},null,8,["comment","content-type","object-pk","token"])})),128))])}var v={class:"unit-0 comment-avatar-box"},g={class:"unit root-comment"},S={class:"comment-user"},j={class:"text-small text-muted comment-user-name"},C={key:0,class:"master"},w=(0,d.createVNode)("i",{class:"ri-share-forward-fill"},null,-1),x={class:"text-small text-muted comment-user-name"},B={key:0,class:"master"},_={class:"comment-footer flex-left"},V={class:"text-small text-muted comment-date"},N={key:1,class:"comment-descendants"};function P(e,t,n,o,c,r){var i=(0,d.resolveComponent)("comment-form"),a=(0,d.resolveComponent)("comment-item",!0);return(0,d.openBlock)(),(0,d.createBlock)("div",{class:"flex-left comment",id:r.commentAnchor},[(0,d.createVNode)("div",v,[(0,d.createVNode)("img",{class:"comment-avatar",alt:"",src:n.comment.user.avatar_url},null,8,["src"])]),(0,d.createVNode)("div",g,[(0,d.createVNode)("header",S,[(0,d.createVNode)("span",j,[(0,d.createTextVNode)((0,d.toDisplayString)(n.comment.user.name)+" ",1),"追梦人物"===n.comment.user.name?((0,d.openBlock)(),(0,d.createBlock)("span",C,"[博主]")):(0,d.createCommentVNode)("",!0)]),r.isRoot?(0,d.createCommentVNode)("",!0):((0,d.openBlock)(),(0,d.createBlock)(d.Fragment,{key:0},[w,(0,d.createVNode)("span",x,[(0,d.createTextVNode)((0,d.toDisplayString)(n.comment.parent_user.name)+" ",1),"追梦人物"===n.comment.parent_user.name?((0,d.openBlock)(),(0,d.createBlock)("span",B,"[博主]")):(0,d.createCommentVNode)("",!0)])],64))]),(0,d.createVNode)("div",{innerHTML:n.comment.comment_html,class:"comment-body"},null,8,["innerHTML"]),(0,d.createVNode)("footer",_,[(0,d.createVNode)("time",V,(0,d.toDisplayString)(n.comment.submit_date),1),r.isAuthenticated?((0,d.openBlock)(),(0,d.createBlock)("a",{key:0,href:"#",class:"text-small text-muted btn-reply",onClick:t[1]||(t[1]=(0,d.withModifiers)((function(e){return c.replying=!c.replying}),["prevent"]))},"回复")):(0,d.createCommentVNode)("",!0)]),c.replying?((0,d.openBlock)(),(0,d.createBlock)(i,{key:0,onDescendantCommentSuccess:r.commentSuccess,flag:r.commentFormFlag,"content-type":n.contentType,"object-pk":n.objectPk,token:n.token,parent:n.comment.id},null,8,["onDescendantCommentSuccess","flag","content-type","object-pk","token","parent"])):(0,d.createCommentVNode)("",!0),r.hasDescendants?((0,d.openBlock)(),(0,d.createBlock)("div",N,[((0,d.openBlock)(!0),(0,d.createBlock)(d.Fragment,null,(0,d.renderList)(c.descendants,(function(e){return(0,d.openBlock)(),(0,d.createBlock)(a,{"content-type":n.contentType,"object-pk":n.objectPk,token:n.token,comment:e,key:e.id},null,8,["content-type","object-pk","token","comment"])})),128))])):(0,d.createCommentVNode)("",!0)])],8,["id"])}var T=(0,d.withScopeId)("data-v-dc621f5c");(0,d.pushScopeId)("data-v-dc621f5c");var O={class:"flex-center comment-form"},L={class:"unit-1 form"},A=(0,d.createVNode)("i",{class:"ri-send-plane-fill","aria-hidden":"true"},null,-1),D=(0,d.createTextVNode)(" 发布 ");(0,d.popScopeId)();var M=T((function(e,t,n,o,c,r){return(0,d.openBlock)(),(0,d.createBlock)("div",O,[(0,d.createVNode)("div",L,[(0,d.withDirectives)((0,d.createVNode)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.value=e}),placeholder:"评论（支持 Markdown 语法）...",rows:"5"},null,512),[[d.vModelText,c.value]]),(0,d.createVNode)("button",{class:"btn btn-default float-right",onClick:t[2]||(t[2]=function(){return r.submitComment&&r.submitComment.apply(r,arguments)})},[A,D])])])})),E=c(376),I=c.n(E),q=I().create({baseURL:"/api/v1",timeout:1e4}),F=q;function R(e,t){return F.get("/comments/security-data/",{params:{content_type:e,object_pk:t}})}function H(e,t){return F.get("/comments/",{params:{content_type:e,object_pk:t}})}function $(e,t){return F.post("/comments/",t,{headers:{Authorization:"Token "+e}})}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J={name:"comment-form",props:{contentType:String,objectPk:String,token:String,parent:Number,flag:String},data:function(){return{value:"",security_data:null}},mounted:function(){var e=this;R(this.contentType,this.objectPk).then((function(t){e.security_data=t.data})).catch((function(e){console.log(e.response)}))},methods:{submitComment:function(){var e=this;0===this.value.length&&alert("请输入评论内容");var t=this.token,n=z({comment:this.value,parent:this.parent},this.security_data);$(t,n).then((function(t){e.$emit(e.flag+"CommentSuccess",t.data),e.value=""})).catch((function(e){console.log(e.response)}))}}};J.render=M,J.__scopeId="data-v-dc621f5c";var K=J,Q={name:"comment-item",components:{CommentForm:K},props:{comment:Object,contentType:String,objectPk:String,token:String},data:function(){return{replying:!1,descendants:[]}},created:function(){this.descendants=this.comment.descendants},methods:{commentSuccess:function(e){this.replying=!this.replying,this.isRoot?this.descendants.push(e):this.$parent.comment.descendants.push(e)}},computed:{commentFormFlag:function(){return"descendant"},hasDescendants:function(){return this.isRoot&&this.comment.descendants.length>0},isRoot:function(){return null===this.comment.parent},isAuthenticated:function(){return 0!==this.token.length},commentAnchor:function(){return"c"+this.comment.id}}};Q.render=P;var W=Q,X={name:"comment-list",components:{CommentItem:W},props:{contentType:String,objectPk:String,token:String,commentList:Array,numComments:Number,numCommentParticipants:Number}};X.render=b;var Y=X;function Z(e){return oe(e)||ne(e)||te(e)||ee()}function ee(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function te(e,t){if(e){if("string"===typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}function ne(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function oe(e){if(Array.isArray(e))return ce(e)}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var re=(0,d.defineComponent)({name:"Comment",components:{CommentList:Y,CommentForm:K},props:{contentType:String,objectPk:String,token:String,numComments:Number,numCommentParticipants:Number},data:function(){return{value:"",commentList:null,loading:!1,next:null}},computed:{isAuthenticated:function(){return this.token&&0!==this.token.length},hasMore:function(){return null!==this.next}},mounted:function(){var e=this;H(this.contentType,this.objectPk).then((function(t){e.commentList=t.data.results,e.next=t.data.next,e.$nextTick((function(){e.scrollToCommentByHash()}))})).catch((function(e){console.log(e.response)}))},methods:{commentSuccess:function(e){e.descendants=[],this.commentList&&this.commentList.unshift(e),this.value=""},loadMore:function(){var e=this;this.loading=!this.loading,F.get(this.next).then((function(t){var n;e.commentList&&(n=e.commentList).push.apply(n,Z(t.data.results)),e.next=t.data.next,e.loading=!e.loading})).catch((function(t){console.log(t.response),e.loading=!e.loading}))},scrollToCommentByHash:function(){var e=window.location.hash;if(""!==e){var t=e.substring(1),n=window.document.getElementById(t);n&&n.scrollIntoView()}}}});re.render=k;var ie=re,ae=jscontext,se=ae.contentType,me=ae.objectPk,le=ae.token,ue=ae.numComments,de=ae.numCommentParticipants;(0,d.createApp)(ie,{contentType:se,objectPk:me,token:le,numComments:ue,numCommentParticipants:de}).mount("#comment_app");var pe={BackTop:i,Offcanvas:u}}(),r}()}));
//# sourceMappingURL=main.61a9c678.js.map